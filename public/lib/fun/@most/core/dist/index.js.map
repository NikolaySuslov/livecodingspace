{"version":3,"file":"index.js","sources":["../src/fatalError.js","../src/scheduler/PropagateTask.js","../src/source/empty.js","../src/source/never.js","../src/source/at.js","../src/source/now.js","../src/source/periodic.js","../src/source/newStream.js","../src/sink/Pipe.js","../src/combinator/slice/bounds.js","../src/fusion/Filter.js","../src/fusion/FilterMap.js","../src/fusion/Map.js","../src/disposable/SettableDisposable.js","../src/combinator/slice/index.js","../src/combinator/zipItems.js","../src/runEffects.js","../src/run.js","../src/sink/RelativeSink.js","../src/combinator/withLocalTime.js","../src/combinator/loop.js","../src/combinator/scan.js","../src/combinator/continueWith.js","../src/combinator/startWith.js","../src/combinator/transform.js","../src/sink/IndexSink.js","../src/invoke.js","../src/combinator/combine.js","../src/combinator/applicative.js","../src/combinator/mergeConcurrently.js","../src/combinator/chain.js","../src/combinator/concatMap.js","../src/combinator/merge.js","../src/combinator/snapshot.js","../src/Queue.js","../src/combinator/zip.js","../src/combinator/switch.js","../src/combinator/filter.js","../src/combinator/timeslice.js","../src/combinator/delay.js","../src/combinator/limit.js","../src/combinator/promises.js","../src/sink/SafeSink.js","../src/source/tryEvent.js","../src/combinator/errors.js","../src/combinator/multicast.js","../src/index.js"],"sourcesContent":["/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexport default function fatalError (e) {\n  setTimeout(rethrow, 0, e)\n}\n\nfunction rethrow (e) {\n  throw e\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport fatal from '../fatalError'\n\nexport const propagateTask = (run, value, sink) => new PropagateTask(run, value, sink)\n\nexport const propagateEventTask = (value, sink) => propagateTask(runEvent, value, sink)\n\nexport const propagateEndTask = sink => propagateTask(runEnd, undefined, sink)\n\nexport const propagateErrorTask = (value, sink) => propagateTask(runError, value, sink)\n\nexport class PropagateTask {\n  constructor (run, value, sink) {\n    this._run = run\n    this.value = value\n    this.sink = sink\n    this.active = true\n  }\n\n  dispose () {\n    this.active = false\n  }\n\n  run (t) {\n    if (!this.active) {\n      return\n    }\n    const run = this._run\n    run(t, this.value, this.sink)\n  }\n\n  error (t, e) {\n    // TODO: Remove this check and just do this.sink.error(t, e)?\n    if (!this.active) {\n      return fatal(e)\n    }\n    this.sink.error(t, e)\n  }\n}\n\nconst runEvent = (t, x, sink) => sink.event(t, x)\n\nconst runEnd = (t, _, sink) => sink.end(t)\n\nconst runError = (t, e, sink) => sink.error(t, e)\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { propagateEndTask } from '../scheduler/PropagateTask'\nimport { asap } from '@most/scheduler'\n\nexport const empty = () => EMPTY\n\nexport const isCanonicalEmpty = stream =>\n  stream === EMPTY\n\nexport const containsCanonicalEmpty = streams =>\n  streams.some(isCanonicalEmpty)\n\nclass Empty {\n  run (sink, scheduler) {\n    return asap(propagateEndTask(sink), scheduler)\n  }\n}\n\nconst EMPTY = new Empty()\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { disposeNone } from '@most/disposable'\n\nexport const never = () => NEVER\n\nclass Never {\n  run () {\n    return disposeNone()\n  }\n}\n\nconst NEVER = new Never()\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { propagateTask } from '../scheduler/PropagateTask'\nimport { delay } from '@most/scheduler'\n\nexport const at = (t, x) => new At(t, x)\n\nclass At {\n  constructor (t, x) {\n    this.time = t\n    this.value = x\n  }\n\n  run (sink, scheduler) {\n    return delay(this.time, propagateTask(runAt, this.value, sink), scheduler)\n  }\n}\n\nfunction runAt (t, x, sink) {\n  sink.event(t, x)\n  sink.end(t)\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { at } from './at'\n\nexport const now = x => at(0, x)\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport { propagateEventTask } from '../scheduler/PropagateTask'\nimport { periodic as schedulePeriodic } from '@most/scheduler'\n\n/**\n * Create a stream of events that occur at a regular period\n * @param {Number} period periodicity of events\n * @returns {Stream} new stream of periodic events, the event value is undefined\n */\nexport const periodic = period =>\n  new Periodic(period)\n\nclass Periodic {\n  constructor (period) {\n    this.period = period\n  }\n\n  run (sink, scheduler) {\n    return schedulePeriodic(this.period, propagateEventTask(undefined, sink), scheduler)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nexport const newStream = run => new Stream(run)\n\nclass Stream {\n  constructor (run) {\n    this.run = run\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n/** @author Brian Cavalier */\n\nexport default class Pipe {\n  constructor (sink) {\n    this.sink = sink\n  }\n\n  event (t, x) {\n    return this.sink.event(t, x)\n  }\n\n  end (t) {\n    return this.sink.end(t)\n  }\n\n  error (t, e) {\n    return this.sink.error(t, e)\n  }\n}\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\n// A slice Bounds type that narrows min values via accumulation\n// and max values via Math.min.\n// type Bounds = { min: number, max: number }\n// Notes:\n// 0 <= min <= max\n// slice(min2, max2, slice(min1, max1, s)) ~ slice(min1 + min2, Math.min(max1, min1 + max2), s)\n// A bounds has a 1d coord system with origin 0, extending to Infinity.  Both min and max\n// are relative to the origin (0).  However, when merging bounds b1 and b2, we\n// *interpret* b2 as being relative to b1, hence adding min1 to *both* min2 and max2.\n// This essentially translates b2's coordinates back into origin coordinates\n// as bounds are merged.\n\n// Construct a constrained bounds\nexport const boundsFrom = (unsafeMin, unsafeMax) => {\n  const min = Math.max(0, unsafeMin)\n  const max = Math.max(min, unsafeMax)\n  return { min, max }\n}\n\n// Combine 2 bounds by narrowing min and max\nexport const mergeBounds = (b1, b2) =>\n  boundsFrom(b1.min + b2.min, Math.min(b1.max, b1.min + b2.max))\n\n// Nil bounds excludes all slice indices\nexport const isNilBounds = b =>\n  b.min >= b.max\n\n// Infinite bounds includes all slice indices\nexport const isInfiniteBounds = b =>\n  b.min <= 0 && b.max === Infinity\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport { isCanonicalEmpty } from '../source/empty'\n\nexport default class Filter {\n  constructor (p, source) {\n    this.p = p\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new FilterSink(this.p, sink), scheduler)\n  }\n\n  /**\n   * Create a filtered source, fusing adjacent filter.filter if possible\n   * @param {function(x:*):boolean} p filtering predicate\n   * @param {{run:function}} source source to filter\n   * @returns {Filter} filtered source\n   */\n  static create (p, source) {\n    if (isCanonicalEmpty(source)) {\n      return source\n    }\n\n    if (source instanceof Filter) {\n      return new Filter(and(source.p, p), source.source)\n    }\n\n    return new Filter(p, source)\n  }\n}\n\nclass FilterSink extends Pipe {\n  constructor (p, sink) {\n    super(sink)\n    this.p = p\n  }\n\n  event (t, x) {\n    const p = this.p\n    p(x) && this.sink.event(t, x)\n  }\n}\n\nconst and = (p, q) => x => p(x) && q(x)\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\n\nexport default class FilterMap {\n  constructor (p, f, source) {\n    this.p = p\n    this.f = f\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new FilterMapSink(this.p, this.f, sink), scheduler)\n  }\n}\n\nclass FilterMapSink extends Pipe {\n  constructor (p, f, sink) {\n    super(sink)\n    this.p = p\n    this.f = f\n  }\n\n  event (t, x) {\n    const f = this.f\n    const p = this.p\n    p(x) && this.sink.event(t, f(x))\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport Filter from './Filter'\nimport FilterMap from './FilterMap'\nimport { compose } from '@most/prelude'\nimport { isCanonicalEmpty, empty } from '../source/empty'\n\nexport default class Map {\n  constructor (f, source) {\n    this.f = f\n    this.source = source\n  }\n\n  run (sink, scheduler) { // eslint-disable-line no-extend-native\n    return this.source.run(new MapSink(this.f, sink), scheduler)\n  }\n\n  /**\n   * Create a mapped source, fusing adjacent map.map, filter.map,\n   * and filter.map.map if possible\n   * @param {function(*):*} f mapping function\n   * @param {{run:function}} source source to map\n   * @returns {Map|FilterMap} mapped source, possibly fused\n   */\n  static create (f, source) {\n    if (isCanonicalEmpty(source)) {\n      return empty()\n    }\n\n    if (source instanceof Map) {\n      return new Map(compose(f, source.f), source.source)\n    }\n\n    if (source instanceof Filter) {\n      return new FilterMap(source.p, f, source.source)\n    }\n\n    return new Map(f, source)\n  }\n}\n\nclass MapSink extends Pipe {\n  constructor (f, sink) {\n    super(sink)\n    this.f = f\n  }\n\n  event (t, x) {\n    const f = this.f\n    this.sink.event(t, f(x))\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nexport default class SettableDisposable {\n  constructor () {\n    this.disposable = undefined\n    this.disposed = false\n  }\n\n  setDisposable (disposable) {\n    if (this.disposable !== void 0) {\n      throw new Error('setDisposable called more than once')\n    }\n\n    this.disposable = disposable\n\n    if (this.disposed) {\n      disposable.dispose()\n    }\n  }\n\n  dispose () {\n    if (this.disposed) {\n      return\n    }\n\n    this.disposed = true\n\n    if (this.disposable !== void 0) {\n      this.disposable.dispose()\n    }\n  }\n}\n","import { empty, isCanonicalEmpty } from '../../source/empty'\nimport { boundsFrom, isNilBounds, isInfiniteBounds, mergeBounds } from './bounds'\nimport Map from '../../fusion/Map'\nimport Pipe from '../../sink/Pipe'\nimport SettableDisposable from '../../disposable/SettableDisposable'\n\n/**\n * @param {number} n\n * @param {Stream} stream\n * @returns {Stream} new stream containing only up to the first n items from stream\n */\nexport const take = (n, stream) =>\n  slice(0, n, stream)\n\n/**\n * @param {number} n\n * @param {Stream} stream\n * @returns {Stream} new stream with the first n items removed\n */\nexport const skip = (n, stream) =>\n  slice(n, Infinity, stream)\n\n/**\n * Slice a stream by index. Negative start/end indexes are not supported\n * @param {number} start\n * @param {number} end\n * @param {Stream} stream\n * @returns {Stream} stream containing items where start <= index < end\n */\nexport const slice = (start, end, stream) =>\n  sliceBounds(boundsFrom(start, end), stream)\n\nconst sliceBounds = (bounds, stream) =>\n  isSliceEmpty(bounds, stream) ? empty()\n    : stream instanceof Map ? commuteMapSlice(bounds, stream)\n      : stream instanceof Slice ? fuseSlice(bounds, stream)\n        : createSlice(bounds, stream)\n\nconst isSliceEmpty = (bounds, stream) =>\n  isCanonicalEmpty(stream) || isNilBounds(bounds)\n\nconst createSlice = (bounds, stream) =>\n  isInfiniteBounds(bounds) ? stream : new Slice(bounds, stream)\n\nconst commuteMapSlice = (bounds, mapStream) =>\n  Map.create(mapStream.f, sliceBounds(bounds, mapStream.source))\n\nconst fuseSlice = (bounds, sliceStream) =>\n  sliceBounds(mergeBounds(sliceStream.bounds, bounds), sliceStream.source)\n\nclass Slice {\n  constructor (bounds, source) {\n    this.source = source\n    this.bounds = bounds\n  }\n\n  run (sink, scheduler) {\n    const disposable = new SettableDisposable()\n    const sliceSink = new SliceSink(this.bounds.min, this.bounds.max - this.bounds.min, sink, disposable)\n\n    disposable.setDisposable(this.source.run(sliceSink, scheduler))\n\n    return disposable\n  }\n}\n\nclass SliceSink extends Pipe {\n  constructor (skip, take, sink, disposable) {\n    super(sink)\n    this.skip = skip\n    this.take = take\n    this.disposable = disposable\n  }\n\n  event (t, x) {\n    /* eslint complexity: [1, 4] */\n    if (this.skip > 0) {\n      this.skip -= 1\n      return\n    }\n\n    if (this.take === 0) {\n      return\n    }\n\n    this.take -= 1\n    this.sink.event(t, x)\n    if (this.take === 0) {\n      this.disposable.dispose()\n      this.sink.end(t)\n    }\n  }\n}\n\nexport const takeWhile = (p, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new TakeWhile(p, stream)\n\nclass TakeWhile {\n  constructor (p, source) {\n    this.p = p\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    const disposable = new SettableDisposable()\n    const takeWhileSink = new TakeWhileSink(this.p, sink, disposable)\n\n    disposable.setDisposable(this.source.run(takeWhileSink, scheduler))\n\n    return disposable\n  }\n}\n\nclass TakeWhileSink extends Pipe {\n  constructor (p, sink, disposable) {\n    super(sink)\n    this.p = p\n    this.active = true\n    this.disposable = disposable\n  }\n\n  event (t, x) {\n    if (!this.active) {\n      return\n    }\n\n    const p = this.p\n    this.active = p(x)\n\n    if (this.active) {\n      this.sink.event(t, x)\n    } else {\n      this.disposable.dispose()\n      this.sink.end(t)\n    }\n  }\n}\n\nexport const skipWhile = (p, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new SkipWhile(p, stream)\n\nclass SkipWhile {\n  constructor (p, source) {\n    this.p = p\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new SkipWhileSink(this.p, sink), scheduler)\n  }\n}\n\nclass SkipWhileSink extends Pipe {\n  constructor (p, sink) {\n    super(sink)\n    this.p = p\n    this.skipping = true\n  }\n\n  event (t, x) {\n    if (this.skipping) {\n      const p = this.p\n      this.skipping = p(x)\n      if (this.skipping) {\n        return\n      }\n    }\n\n    this.sink.event(t, x)\n  }\n}\n\nexport const skipAfter = (p, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new SkipAfter(p, stream)\n\nclass SkipAfter {\n  constructor (p, source) {\n    this.p = p\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new SkipAfterSink(this.p, sink), scheduler)\n  }\n}\n\nclass SkipAfterSink extends Pipe {\n  constructor (p, sink) {\n    super(sink)\n    this.p = p\n    this.skipping = false\n  }\n\n  event (t, x) {\n    if (this.skipping) {\n      return\n    }\n\n    const p = this.p\n    this.skipping = p(x)\n    this.sink.event(t, x)\n\n    if (this.skipping) {\n      this.sink.end(t)\n    }\n  }\n}\n","/** @license MIT License (c) copyright 2017 original author or authors */\n\nimport Pipe from '../sink/Pipe'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { take } from './slice'\n\nexport const withItems = (items, stream) =>\n  zipItems(keepLeft, items, stream)\n\nexport const zipItems = (f, items, stream) =>\n  isCanonicalEmpty(stream) || items.length === 0\n    ? empty()\n    : new ZipItems(f, items, take(items.length, stream))\n\nconst keepLeft = (a, _) => a\n\nclass ZipItems {\n  constructor (f, items, source) {\n    this.f = f\n    this.items = items\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new ZipItemsSink(this.f, this.items, sink), scheduler)\n  }\n}\n\nclass ZipItemsSink extends Pipe {\n  constructor (f, items, sink) {\n    super(sink)\n    this.f = f\n    this.items = items\n    this.index = 0\n  }\n\n  event (t, b) {\n    const f = this.f\n    this.sink.event(t, f(this.items[this.index], b))\n    this.index += 1\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { curry2 } from '@most/prelude'\nimport SettableDisposable from './disposable/SettableDisposable'\n\nexport const runEffects = curry2((stream, scheduler) =>\n  new Promise((resolve, reject) =>\n    runStream(stream, scheduler, resolve, reject)))\n\nfunction runStream (stream, scheduler, resolve, reject) {\n  const disposable = new SettableDisposable()\n  const observer = new RunEffectsSink(resolve, reject, disposable)\n\n  disposable.setDisposable(stream.run(observer, scheduler))\n}\n\nclass RunEffectsSink {\n  constructor (end, error, disposable) {\n    this._end = end\n    this._error = error\n    this._disposable = disposable\n    this.active = true\n  }\n\n  event (t, x) {}\n\n  end (t) {\n    if (!this.active) {\n      return\n    }\n    this._dispose(this._error, this._end, undefined)\n  }\n\n  error (t, e) {\n    this._dispose(this._error, this._error, e)\n  }\n\n  _dispose (error, end, x) {\n    this.active = false\n    tryDispose(error, end, x, this._disposable)\n  }\n}\n\nfunction tryDispose (error, end, x, disposable) {\n  try {\n    disposable.dispose()\n  } catch (e) {\n    error(e)\n    return\n  }\n\n  end(x)\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\n// Run a Stream, sending all its events to the\n// provided Sink.\nexport const run = (sink, scheduler, stream) =>\n  stream.run(sink, scheduler)\n","export default class RelativeSink {\n  constructor (offset, sink) {\n    this.sink = sink\n    this.offset = offset\n  }\n\n  event (t, x) {\n    this.sink.event(t + this.offset, x)\n  }\n\n  error (t, e) {\n    this.sink.error(t + this.offset, e)\n  }\n\n  end (t) {\n    this.sink.end(t + this.offset)\n  }\n}\n","import RelativeSink from '../sink/RelativeSink'\nimport { schedulerRelativeTo } from '@most/scheduler'\n\n// Create a stream with its own local clock\n// This transforms time from the provided scheduler's clock to a stream-local\n// clock (which starts at 0), and then *back* to the scheduler's clock before\n// propagating events to sink.  In other words, upstream sources will see local times,\n// and downstream sinks will see non-local (original) times.\nexport const withLocalTime = (origin, stream) =>\n  new WithLocalTime(origin, stream)\n\nclass WithLocalTime {\n  constructor (origin, source) {\n    this.origin = origin\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(relativeSink(this.origin, sink), schedulerRelativeTo(this.origin, scheduler))\n  }\n}\n\n// Accumulate offsets instead of nesting RelativeSinks, which can happen\n// with higher-order stream and combinators like continueWith when they're\n// applied recursively.\nexport const relativeSink = (origin, sink) =>\n  sink instanceof RelativeSink\n    ? new RelativeSink(origin + sink.offset, sink.sink)\n    : new RelativeSink(origin, sink)\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\nimport Pipe from '../sink/Pipe'\nimport { empty, isCanonicalEmpty } from '../source/empty'\n\n/**\n * Generalized feedback loop. Call a stepper function for each event. The stepper\n * will be called with 2 params: the current seed and the an event value.  It must\n * return a new { seed, value } pair. The `seed` will be fed back into the next\n * invocation of stepper, and the `value` will be propagated as the event value.\n * @param {function(seed:*, value:*):{seed:*, value:*}} stepper loop step function\n * @param {*} seed initial seed value passed to first stepper call\n * @param {Stream} stream event stream\n * @returns {Stream} new stream whose values are the `value` field of the objects\n * returned by the stepper\n */\nexport const loop = (stepper, seed, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new Loop(stepper, seed, stream)\n\nclass Loop {\n  constructor (stepper, seed, source) {\n    this.step = stepper\n    this.seed = seed\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new LoopSink(this.step, this.seed, sink), scheduler)\n  }\n}\n\nclass LoopSink extends Pipe {\n  constructor (stepper, seed, sink) {\n    super(sink)\n    this.step = stepper\n    this.seed = seed\n  }\n\n  event (t, x) {\n    const result = this.step(this.seed, x)\n    this.seed = result.seed\n    this.sink.event(t, result.value)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport { disposeBoth } from '@most/disposable'\nimport { asap } from '@most/scheduler'\nimport { propagateEventTask } from '../scheduler/PropagateTask'\n\n/**\n * Create a stream containing successive reduce results of applying f to\n * the previous reduce result and the current stream item.\n * @param {function(result:*, x:*):*} f reducer function\n * @param {*} initial initial value\n * @param {Stream} stream stream to scan\n * @returns {Stream} new stream containing successive reduce results\n */\nexport const scan = (f, initial, stream) =>\n  new Scan(f, initial, stream)\n\nclass Scan {\n  constructor (f, z, source) {\n    this.source = source\n    this.f = f\n    this.value = z\n  }\n\n  run (sink, scheduler) {\n    const d1 = asap(propagateEventTask(this.value, sink), scheduler)\n    const d2 = this.source.run(new ScanSink(this.f, this.value, sink), scheduler)\n    return disposeBoth(d1, d2)\n  }\n}\n\nclass ScanSink extends Pipe {\n  constructor (f, z, sink) {\n    super(sink)\n    this.f = f\n    this.value = z\n  }\n\n  event (t, x) {\n    const f = this.f\n    this.value = f(this.value, x)\n    this.sink.event(t, this.value)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport { run } from '../run'\nimport { withLocalTime } from '../combinator/withLocalTime'\nimport { disposeOnce, tryDispose } from '@most/disposable'\n\nexport const continueWith = (f, stream) =>\n  new ContinueWith(f, stream)\n\nclass ContinueWith {\n  constructor (f, source) {\n    this.f = f\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return new ContinueWithSink(this.f, this.source, sink, scheduler)\n  }\n}\n\nclass ContinueWithSink extends Pipe {\n  constructor (f, source, sink, scheduler) {\n    super(sink)\n    this.f = f\n    this.scheduler = scheduler\n    this.active = true\n    this.disposable = disposeOnce(source.run(this, scheduler))\n  }\n\n  event (t, x) {\n    if (!this.active) {\n      return\n    }\n    this.sink.event(t, x)\n  }\n\n  end (t) {\n    if (!this.active) {\n      return\n    }\n\n    tryDispose(t, this.disposable, this.sink)\n\n    this._startNext(t, this.sink)\n  }\n\n  _startNext (t, sink) {\n    try {\n      this.disposable = this._continue(this.f, t, sink)\n    } catch (e) {\n      sink.error(t, e)\n    }\n  }\n\n  _continue (f, t, sink) {\n    return run(sink, this.scheduler, withLocalTime(t, f()))\n  }\n\n  dispose () {\n    this.active = false\n    return this.disposable.dispose()\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { now } from '../source/now'\nimport { continueWith } from './continueWith'\n\nexport const startWith = (x, stream) =>\n  continueWith(() => stream, now(x))\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Map from '../fusion/Map'\nimport Pipe from '../sink/Pipe'\n\n/**\n * Transform each value in the stream by applying f to each\n * @param {function(*):*} f mapping function\n * @param {Stream} stream stream to map\n * @returns {Stream} stream containing items transformed by f\n */\nexport const map = (f, stream) =>\n  Map.create(f, stream)\n\n/**\n* Replace each value in the stream with x\n* @param {*} x\n* @param {Stream} stream\n* @returns {Stream} stream containing items replaced with x\n*/\nexport const constant = (x, stream) =>\n  map(() => x, stream)\n\n/**\n* Perform a side effect for each item in the stream\n* @param {function(x:*):*} f side effect to execute for each item. The\n*  return value will be discarded.\n* @param {Stream} stream stream to tap\n* @returns {Stream} new stream containing the same items as this stream\n*/\nexport const tap = (f, stream) =>\n  new Tap(f, stream)\n\nclass Tap {\n  constructor (f, source) {\n    this.source = source\n    this.f = f\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new TapSink(this.f, sink), scheduler)\n  }\n}\n\nclass TapSink extends Pipe {\n  constructor (f, sink) {\n    super(sink)\n    this.f = f\n  }\n\n  event (t, x) {\n    const f = this.f\n    f(x)\n    this.sink.event(t, x)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Sink from './Pipe'\n\nexport default class IndexSink extends Sink {\n  constructor (i, sink) {\n    super(sink)\n    this.index = i\n    this.active = true\n    this.value = undefined\n  }\n\n  event (t, x) {\n    if (!this.active) {\n      return\n    }\n    this.value = x\n    this.sink.event(t, this)\n  }\n\n  end (t) {\n    if (!this.active) {\n      return\n    }\n    this.active = false\n    this.sink.event(t, this)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexport default function invoke (f, args) {\n  /* eslint complexity: [2,7] */\n  switch (args.length) {\n    case 0: return f()\n    case 1: return f(args[0])\n    case 2: return f(args[0], args[1])\n    case 3: return f(args[0], args[1], args[2])\n    case 4: return f(args[0], args[1], args[2], args[3])\n    case 5: return f(args[0], args[1], args[2], args[3], args[4])\n    default:\n      return f.apply(void 0, args)\n  }\n}\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\nimport { map } from './transform'\nimport { empty, containsCanonicalEmpty } from '../source/empty'\nimport Pipe from '../sink/Pipe'\nimport IndexSink from '../sink/IndexSink'\nimport { disposeAll, tryDispose } from '@most/disposable'\nimport invoke from '../invoke'\n\n/**\n * Combine latest events from two streams\n * @param {function(...events):*} f function to combine most recent events\n * @returns {Stream} stream containing the result of applying f to the most recent\n *  event of each input stream, whenever a new event arrives on any stream.\n */\nexport const combine = (f, stream1, stream2) =>\n  combineArray(f, [stream1, stream2])\n\n/**\n* Combine latest events from all input streams\n* @param {function(...events):*} f function to combine most recent events\n* @param {[Stream]} streams most recent events\n* @returns {Stream} stream containing the result of applying f to the most recent\n*  event of each input stream, whenever a new event arrives on any stream.\n*/\nexport const combineArray = (f, streams) =>\n  streams.length === 0 || containsCanonicalEmpty(streams) ? empty()\n    : streams.length === 1 ? map(f, streams[0])\n      : new Combine(f, streams)\n\nclass Combine {\n  constructor (f, sources) {\n    this.f = f\n    this.sources = sources\n  }\n\n  run (sink, scheduler) {\n    const l = this.sources.length\n    const disposables = new Array(l)\n    const sinks = new Array(l)\n\n    const mergeSink = new CombineSink(disposables, sinks, sink, this.f)\n\n    for (let indexSink, i = 0; i < l; ++i) {\n      indexSink = sinks[i] = new IndexSink(i, mergeSink)\n      disposables[i] = this.sources[i].run(indexSink, scheduler)\n    }\n\n    return disposeAll(disposables)\n  }\n}\n\nclass CombineSink extends Pipe {\n  constructor (disposables, sinks, sink, f) {\n    super(sink)\n    this.disposables = disposables\n    this.sinks = sinks\n    this.f = f\n\n    const l = sinks.length\n    this.awaiting = l\n    this.values = new Array(l)\n    this.hasValue = new Array(l).fill(false)\n    this.activeCount = sinks.length\n  }\n\n  event (t, indexedValue) {\n    if (!indexedValue.active) {\n      this._dispose(t, indexedValue.index)\n      return\n    }\n\n    const i = indexedValue.index\n    const awaiting = this._updateReady(i)\n\n    this.values[i] = indexedValue.value\n    if (awaiting === 0) {\n      this.sink.event(t, invoke(this.f, this.values))\n    }\n  }\n\n  _updateReady (index) {\n    if (this.awaiting > 0) {\n      if (!this.hasValue[index]) {\n        this.hasValue[index] = true\n        this.awaiting -= 1\n      }\n    }\n    return this.awaiting\n  }\n\n  _dispose (t, index) {\n    tryDispose(t, this.disposables[index], this.sink)\n    if (--this.activeCount === 0) {\n      this.sink.end(t)\n    }\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport { combine } from './combine'\nimport { apply } from '@most/prelude'\n\n/**\n * Assume fs is a stream containing functions, and apply the latest function\n * in fs to the latest value in xs.\n * fs:         --f---------g--------h------>\n * xs:         -a-------b-------c-------d-->\n * ap(fs, xs): --fa-----fb-gb---gc--hc--hd->\n * @param {Stream} fs stream of functions to apply to the latest x\n * @param {Stream} xs stream of values to which to apply all the latest f\n * @returns {Stream} stream containing all the applications of fs to xs\n */\nexport function ap (fs, xs) {\n  return combine(apply, fs, xs)\n}\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\nimport { disposeAll, disposeNone, disposeOnce, tryDispose } from '@most/disposable'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { id as identity } from '@most/prelude'\nimport { schedulerRelativeTo } from '@most/scheduler'\n\nexport const mergeConcurrently = (concurrency, stream) =>\n  mergeMapConcurrently(identity, concurrency, stream)\n\nexport const mergeMapConcurrently = (f, concurrency, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new MergeConcurrently(f, concurrency, stream)\n\nclass MergeConcurrently {\n  constructor (f, concurrency, source) {\n    this.f = f\n    this.concurrency = concurrency\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return new Outer(this.f, this.concurrency, this.source, sink, scheduler)\n  }\n}\n\nclass Outer {\n  constructor (f, concurrency, source, sink, scheduler) {\n    this.f = f\n    this.concurrency = concurrency\n    this.sink = sink\n    this.scheduler = scheduler\n    this.pending = []\n    this.current = []\n    this.disposable = disposeOnce(source.run(this, scheduler))\n    this.active = true\n  }\n\n  event (t, x) {\n    this._addInner(t, x)\n  }\n\n  _addInner (t, x) {\n    if (this.current.length < this.concurrency) {\n      this._startInner(t, x)\n    } else {\n      this.pending.push(x)\n    }\n  }\n\n  _startInner (t, x) {\n    try {\n      this._initInner(t, x)\n    } catch (e) {\n      this.error(t, e)\n    }\n  }\n\n  _initInner (t, x) {\n    const innerSink = new Inner(t, this, this.sink)\n    innerSink.disposable = mapAndRun(this.f, t, x, innerSink, this.scheduler)\n    this.current.push(innerSink)\n  }\n\n  end (t) {\n    this.active = false\n    tryDispose(t, this.disposable, this.sink)\n    this._checkEnd(t)\n  }\n\n  error (t, e) {\n    this.active = false\n    this.sink.error(t, e)\n  }\n\n  dispose () {\n    this.active = false\n    this.pending.length = 0\n    this.disposable.dispose()\n    disposeAll(this.current).dispose()\n  }\n\n  _endInner (t, inner) {\n    const i = this.current.indexOf(inner)\n    if (i >= 0) {\n      this.current.splice(i, 1)\n    }\n    tryDispose(t, inner, this)\n\n    if (this.pending.length === 0) {\n      this._checkEnd(t)\n    } else {\n      this._startInner(t, this.pending.shift())\n    }\n  }\n\n  _checkEnd (t) {\n    if (!this.active && this.current.length === 0) {\n      this.sink.end(t)\n    }\n  }\n}\n\nconst mapAndRun = (f, t, x, sink, scheduler) =>\n  f(x).run(sink, schedulerRelativeTo(t, scheduler))\n\nclass Inner {\n  constructor (time, outer, sink) {\n    this.time = time\n    this.outer = outer\n    this.sink = sink\n    this.disposable = disposeNone()\n  }\n\n  event (t, x) {\n    this.sink.event(t + this.time, x)\n  }\n\n  end (t) {\n    this.outer._endInner(t + this.time, this)\n  }\n\n  error (t, e) {\n    this.outer.error(t + this.time, e)\n  }\n\n  dispose () {\n    return this.disposable.dispose()\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport { mergeConcurrently, mergeMapConcurrently } from './mergeConcurrently'\n\n/**\n * Map each value in the stream to a new stream, and merge it into the\n * returned outer stream. Event arrival times are preserved.\n * @param {function(x:*):Stream} f chaining function, must return a Stream\n * @param {Stream} stream\n * @returns {Stream} new stream containing all events from each stream returned by f\n */\nexport const chain = (f, stream) => mergeMapConcurrently(f, Infinity, stream)\n\n/**\n * Monadic join. Flatten a Stream<Stream<X>> to Stream<X> by merging inner\n * streams to the outer. Event arrival times are preserved.\n * @param {Stream<Stream<X>>} stream stream of streams\n * @returns {Stream<X>} new stream containing all events of all inner streams\n */\nexport const join = stream => mergeConcurrently(Infinity, stream)\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport { mergeMapConcurrently } from './mergeConcurrently'\n\n/**\n * Map each value in stream to a new stream, and concatenate them all\n * stream:              -a---b---cX\n * f(a):                 1-1-1-1X\n * f(b):                        -2-2-2-2X\n * f(c):                                -3-3-3-3X\n * stream.concatMap(f): -1-1-1-1-2-2-2-2-3-3-3-3X\n * @param {function(x:*):Stream} f function to map each value to a stream\n * @param {Stream} stream\n * @returns {Stream} new stream containing all events from each stream returned by f\n */\nexport const concatMap = (f, stream) =>\n  mergeMapConcurrently(f, 1, stream)\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport IndexSink from '../sink/IndexSink'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { disposeAll, tryDispose } from '@most/disposable'\nimport { reduce } from '@most/prelude'\n\n/**\n * @returns {Stream} stream containing events from two streams in time order.\n * If two events are simultaneous they will be merged in arbitrary order.\n */\nexport function merge (stream1, stream2) {\n  return mergeArray([stream1, stream2])\n}\n\n/**\n * @param {Array} streams array of stream to merge\n * @returns {Stream} stream containing events from all input observables\n * in time order.  If two events are simultaneous they will be merged in\n * arbitrary order.\n */\nexport const mergeArray = streams =>\n  mergeStreams(withoutCanonicalEmpty(streams))\n\n/**\n * This implements fusion/flattening for merge.  It will\n * fuse adjacent merge operations.  For example:\n * - a.merge(b).merge(c) effectively becomes merge(a, b, c)\n * - merge(a, merge(b, c)) effectively becomes merge(a, b, c)\n * It does this by concatenating the sources arrays of\n * any nested Merge sources, in effect \"flattening\" nested\n * merge operations into a single merge.\n */\nconst mergeStreams = streams =>\n  streams.length === 0 ? empty()\n    : streams.length === 1 ? streams[0]\n      : new Merge(reduce(appendSources, [], streams))\n\nconst withoutCanonicalEmpty = streams =>\n  streams.filter(isNotCanonicalEmpty)\n\nconst isNotCanonicalEmpty = stream =>\n  !isCanonicalEmpty(stream)\n\nconst appendSources = (sources, stream) =>\n  sources.concat(stream instanceof Merge ? stream.sources : stream)\n\nclass Merge {\n  constructor (sources) {\n    this.sources = sources\n  }\n\n  run (sink, scheduler) {\n    const l = this.sources.length\n    const disposables = new Array(l)\n    const sinks = new Array(l)\n\n    const mergeSink = new MergeSink(disposables, sinks, sink)\n\n    for (let indexSink, i = 0; i < l; ++i) {\n      indexSink = sinks[i] = new IndexSink(i, mergeSink)\n      disposables[i] = this.sources[i].run(indexSink, scheduler)\n    }\n\n    return disposeAll(disposables)\n  }\n}\n\nclass MergeSink extends Pipe {\n  constructor (disposables, sinks, sink) {\n    super(sink)\n    this.disposables = disposables\n    this.activeCount = sinks.length\n  }\n\n  event (t, indexValue) {\n    if (!indexValue.active) {\n      this._dispose(t, indexValue.index)\n      return\n    }\n    this.sink.event(t, indexValue.value)\n  }\n\n  _dispose (t, index) {\n    tryDispose(t, this.disposables[index], this.sink)\n    if (--this.activeCount === 0) {\n      this.sink.end(t)\n    }\n  }\n}\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\nimport Pipe from '../sink/Pipe'\nimport { disposeBoth } from '@most/disposable'\nimport { empty, isCanonicalEmpty } from '../source/empty'\n\nexport const sample = (values, sampler) =>\n  snapshot((x, _) => x, values, sampler)\n\nexport const snapshot = (f, values, sampler) =>\n  isCanonicalEmpty(sampler) || isCanonicalEmpty(values)\n    ? empty()\n    : new Snapshot(f, values, sampler)\n\nexport class Snapshot {\n  constructor (f, values, sampler) {\n    this.f = f\n    this.values = values\n    this.sampler = sampler\n  }\n\n  run (sink, scheduler) {\n    const sampleSink = new SnapshotSink(this.f, sink)\n    const valuesDisposable = this.values.run(sampleSink.latest, scheduler)\n    const samplerDisposable = this.sampler.run(sampleSink, scheduler)\n\n    return disposeBoth(samplerDisposable, valuesDisposable)\n  }\n}\n\nexport class SnapshotSink extends Pipe {\n  constructor (f, sink) {\n    super(sink)\n    this.f = f\n    this.latest = new LatestValueSink(this)\n  }\n\n  event (t, x) {\n    if (this.latest.hasValue) {\n      const f = this.f\n      this.sink.event(t, f(this.latest.value, x))\n    }\n  }\n}\n\nexport class LatestValueSink extends Pipe {\n  constructor (sink) {\n    super(sink)\n    this.hasValue = false\n  }\n\n  event (t, x) {\n    this.value = x\n    this.hasValue = true\n  }\n\n  end () {}\n}\n","// Copied and modified from https://github.com/invertase/denque\n// MIT License\n\n// These constants were extracted directly from denque's shift()\n// It's not clear exactly why the authors chose these particular\n// values, but given denque's stated goals, it seems likely that\n// they were chosen for speed/memory reasons.\n\n// Max value of _head at which Queue is willing to shink\n// its internal array\nconst HEAD_MAX_SHRINK = 2\n\n// Min value of _tail at which Queue is willing to shink\n// its internal array\nconst TAIL_MIN_SHRINK = 10000\n\nexport default class Queue {\n  constructor () {\n    this._head = 0\n    this._tail = 0\n    this._capacityMask = 0x3\n    this._list = new Array(4)\n  }\n\n  push (x) {\n    const tail = this._tail\n    this._list[tail] = x\n    this._tail = (tail + 1) & this._capacityMask\n    if (this._tail === this._head) {\n      this._growArray()\n    }\n\n    if (this._head < this._tail) {\n      return this._tail - this._head\n    } else {\n      return this._capacityMask + 1 - (this._head - this._tail)\n    }\n  }\n\n  shift () {\n    const head = this._head\n    if (head === this._tail) {\n      return undefined\n    }\n\n    const x = this._list[head]\n    this._list[head] = undefined\n    this._head = (head + 1) & this._capacityMask\n    if (head < HEAD_MAX_SHRINK &&\n      this._tail > TAIL_MIN_SHRINK &&\n      this._tail <= this._list.length >>> 2) {\n      this._shrinkArray()\n    }\n\n    return x\n  }\n\n  isEmpty () {\n    return this._head === this._tail\n  }\n\n  length () {\n    if (this._head === this._tail) {\n      return 0\n    } else if (this._head < this._tail) {\n      return this._tail - this._head\n    } else {\n      return this._capacityMask + 1 - (this._head - this._tail)\n    }\n  }\n\n  _growArray () {\n    if (this._head) {\n      // copy existing data, head to end, then beginning to tail.\n      this._list = this._copyArray()\n      this._head = 0\n    }\n\n    // head is at 0 and array is now full, safe to extend\n    this._tail = this._list.length\n\n    this._list.length *= 2\n    this._capacityMask = (this._capacityMask << 1) | 1\n  }\n\n  _shrinkArray () {\n    this._list.length >>>= 1\n    this._capacityMask >>>= 1\n  }\n\n  _copyArray () {\n    const newArray = []\n    const list = this._list\n    const len = list.length\n\n    let i\n    for (i = this._head; i < len; i++) {\n      newArray.push(list[i])\n    }\n    for (i = 0; i < this._tail; i++) {\n      newArray.push(list[i])\n    }\n\n    return newArray\n  }\n}\n","/** @license MIT License (c) copyright 2010 original author or authors */\n\nimport { map } from './transform'\nimport { empty, containsCanonicalEmpty } from '../source/empty'\nimport Pipe from '../sink/Pipe'\nimport IndexSink from '../sink/IndexSink'\nimport { disposeAll } from '@most/disposable'\nimport { map as mapArray } from '@most/prelude'\nimport invoke from '../invoke'\nimport Queue from '../Queue'\n\n/**\n * Combine two streams pairwise by index by applying f to values at corresponding\n * indices.  The returned stream ends when either of the input streams ends.\n * @param {function} f function to combine values\n * @returns {Stream} new stream with items at corresponding indices combined\n *  using f\n */\nexport function zip (f, stream1, stream2) {\n  return zipArray(f, [stream1, stream2])\n}\n\n/**\n* Combine streams pairwise (or tuple-wise) by index by applying f to values\n* at corresponding indices.  The returned stream ends when any of the input\n* streams ends.\n* @param {function} f function to combine values\n* @param {[Stream]} streams streams to zip using f\n* @returns {Stream} new stream with items at corresponding indices combined\n*  using f\n*/\nexport const zipArray = (f, streams) =>\n  streams.length === 0 || containsCanonicalEmpty(streams) ? empty()\n    : streams.length === 1 ? map(f, streams[0])\n      : new Zip(f, streams)\n\nclass Zip {\n  constructor (f, sources) {\n    this.f = f\n    this.sources = sources\n  }\n\n  run (sink, scheduler) {\n    const l = this.sources.length\n    const disposables = new Array(l)\n    const sinks = new Array(l)\n    const buffers = new Array(l)\n\n    const zipSink = new ZipSink(this.f, buffers, sinks, sink)\n\n    for (let indexSink, i = 0; i < l; ++i) {\n      buffers[i] = new Queue()\n      indexSink = sinks[i] = new IndexSink(i, zipSink)\n      disposables[i] = this.sources[i].run(indexSink, scheduler)\n    }\n\n    return disposeAll(disposables)\n  }\n}\n\nclass ZipSink extends Pipe {\n  constructor (f, buffers, sinks, sink) {\n    super(sink)\n    this.f = f\n    this.sinks = sinks\n    this.buffers = buffers\n  }\n\n  event (t, indexedValue) {\n    /* eslint complexity: [1, 5] */\n    if (!indexedValue.active) {\n      this._dispose(t, indexedValue.index)\n      return\n    }\n\n    const buffers = this.buffers\n    const buffer = buffers[indexedValue.index]\n\n    buffer.push(indexedValue.value)\n\n    if (buffer.length() === 1) {\n      if (!ready(this.buffers)) {\n        return\n      }\n\n      emitZipped(this.f, t, buffers, this.sink)\n\n      if (ended(this.buffers, this.sinks)) {\n        this.sink.end(t)\n      }\n    }\n  }\n\n  _dispose (t, index) {\n    const buffer = this.buffers[index]\n    if (buffer.isEmpty()) {\n      this.sink.end(t)\n    }\n  }\n}\n\nconst emitZipped = (f, t, buffers, sink) =>\n  sink.event(t, invoke(f, mapArray(head, buffers)))\n\nconst head = buffer => buffer.shift()\n\nfunction ended (buffers, sinks) {\n  for (let i = 0, l = buffers.length; i < l; ++i) {\n    if (buffers[i].isEmpty() && !sinks[i].active) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction ready (buffers) {\n  for (let i = 0, l = buffers.length; i < l; ++i) {\n    if (buffers[i].isEmpty()) {\n      return false\n    }\n  }\n  return true\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport { disposeBoth, tryDispose } from '@most/disposable'\nimport { schedulerRelativeTo, currentTime } from '@most/scheduler'\nimport { empty, isCanonicalEmpty } from '../source/empty'\n\n/**\n * Given a stream of streams, return a new stream that adopts the behavior\n * of the most recent inner stream.\n * @param {Stream} stream of streams on which to switch\n * @returns {Stream} switching stream\n */\nexport const switchLatest = stream =>\n  isCanonicalEmpty(stream)\n    ? empty()\n    : new Switch(stream)\n\nclass Switch {\n  constructor (source) {\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    const switchSink = new SwitchSink(sink, scheduler)\n    return disposeBoth(switchSink, this.source.run(switchSink, scheduler))\n  }\n}\n\nclass SwitchSink {\n  constructor (sink, scheduler) {\n    this.sink = sink\n    this.scheduler = scheduler\n    this.current = null\n    this.ended = false\n  }\n\n  event (t, stream) {\n    this._disposeCurrent(t)\n    this.current = new Segment(stream, t, Infinity, this, this.sink, this.scheduler)\n  }\n\n  end (t) {\n    this.ended = true\n    this._checkEnd(t)\n  }\n\n  error (t, e) {\n    this.ended = true\n    this.sink.error(t, e)\n  }\n\n  dispose () {\n    return this._disposeCurrent(currentTime(this.scheduler))\n  }\n\n  _disposeCurrent (t) {\n    if (this.current !== null) {\n      return this.current._dispose(t)\n    }\n  }\n\n  _disposeInner (t, inner) {\n    inner._dispose(t)\n    if (inner === this.current) {\n      this.current = null\n    }\n  }\n\n  _checkEnd (t) {\n    if (this.ended && this.current === null) {\n      this.sink.end(t)\n    }\n  }\n\n  _endInner (t, inner) {\n    this._disposeInner(t, inner)\n    this._checkEnd(t)\n  }\n\n  _errorInner (t, e, inner) {\n    this._disposeInner(t, inner)\n    this.sink.error(t, e)\n  }\n}\n\nclass Segment {\n  constructor (source, min, max, outer, sink, scheduler) {\n    this.min = min\n    this.max = max\n    this.outer = outer\n    this.sink = sink\n    this.disposable = source.run(this, schedulerRelativeTo(min, scheduler))\n  }\n\n  event (t, x) {\n    const time = Math.max(0, t + this.min)\n    if (time < this.max) {\n      this.sink.event(time, x)\n    }\n  }\n\n  end (t) {\n    this.outer._endInner(t + this.min, this)\n  }\n\n  error (t, e) {\n    this.outer._errorInner(t + this.min, e, this)\n  }\n\n  _dispose (t) {\n    tryDispose(t, this.disposable, this.sink)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport Filter from '../fusion/Filter'\nimport { empty, isCanonicalEmpty } from '../source/empty'\n\n/**\n * Retain only items matching a predicate\n * @param {function(x:*):boolean} p filtering predicate called for each item\n * @param {Stream} stream stream to filter\n * @returns {Stream} stream containing only items for which predicate returns truthy\n */\nexport const filter = (p, stream) =>\n  Filter.create(p, stream)\n\n/**\n * Skip repeated events, using === to detect duplicates\n * @param {Stream} stream stream from which to omit repeated events\n * @returns {Stream} stream without repeated events\n */\nexport const skipRepeats = stream =>\n  skipRepeatsWith(same, stream)\n\n/**\n * Skip repeated events using the provided equals function to detect duplicates\n * @param {function(a:*, b:*):boolean} equals optional function to compare items\n * @param {Stream} stream stream from which to omit repeated events\n * @returns {Stream} stream without repeated events\n */\nexport const skipRepeatsWith = (equals, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new SkipRepeats(equals, stream)\n\nclass SkipRepeats {\n  constructor (equals, source) {\n    this.equals = equals\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new SkipRepeatsSink(this.equals, sink), scheduler)\n  }\n}\n\nclass SkipRepeatsSink extends Pipe {\n  constructor (equals, sink) {\n    super(sink)\n    this.equals = equals\n    this.value = void 0\n    this.init = true\n  }\n\n  event (t, x) {\n    if (this.init) {\n      this.init = false\n      this.value = x\n      this.sink.event(t, x)\n    } else if (!this.equals(this.value, x)) {\n      this.value = x\n      this.sink.event(t, x)\n    }\n  }\n}\n\nfunction same (a, b) {\n  return a === b\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport { disposeBoth } from '@most/disposable'\nimport { join } from './chain'\nimport SettableDisposable from '../disposable/SettableDisposable'\n\nexport const until = (signal, stream) =>\n  new Until(signal, stream)\n\nexport const since = (signal, stream) =>\n  new Since(signal, stream)\n\nexport const during = (timeWindow, stream) =>\n  until(join(timeWindow), since(timeWindow, stream))\n\nclass Until {\n  constructor (maxSignal, source) {\n    this.maxSignal = maxSignal\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    const disposable = new SettableDisposable()\n\n    const d1 = this.source.run(sink, scheduler)\n    const d2 = this.maxSignal.run(new UntilSink(sink, disposable), scheduler)\n    disposable.setDisposable(disposeBoth(d1, d2))\n\n    return disposable\n  }\n}\n\nclass Since {\n  constructor (minSignal, source) {\n    this.minSignal = minSignal\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    const min = new LowerBoundSink(this.minSignal, sink, scheduler)\n    const d = this.source.run(new SinceSink(min, sink), scheduler)\n\n    return disposeBoth(min, d)\n  }\n}\n\nclass SinceSink extends Pipe {\n  constructor (min, sink) {\n    super(sink)\n    this.min = min\n  }\n\n  event (t, x) {\n    if (this.min.allow) {\n      this.sink.event(t, x)\n    }\n  }\n}\n\nclass LowerBoundSink extends Pipe {\n  constructor (signal, sink, scheduler) {\n    super(sink)\n    this.allow = false\n    this.disposable = signal.run(this, scheduler)\n  }\n\n  event (/* t, x */) {\n    this.allow = true\n    this.dispose()\n  }\n\n  end () {}\n\n  dispose () {\n    this.disposable.dispose()\n  }\n}\n\nclass UntilSink extends Pipe {\n  constructor (sink, disposable) {\n    super(sink)\n    this.disposable = disposable\n  }\n\n  event (t, x) {\n    this.disposable.dispose()\n    this.sink.end(t)\n  }\n\n  end () {}\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport Pipe from '../sink/Pipe'\nimport { disposeBoth } from '@most/disposable'\nimport { cancelTask, delay as scheduleDelay } from '@most/scheduler'\nimport { propagateEndTask, propagateEventTask } from '../scheduler/PropagateTask'\n\n/**\n * @param {Number} delayTime milliseconds to delay each item\n * @param {Stream} stream\n * @returns {Stream} new stream containing the same items, but delayed by ms\n */\nexport const delay = (delayTime, stream) =>\n  delayTime <= 0 ? stream : new Delay(delayTime, stream)\n\nclass Delay {\n  constructor (dt, source) {\n    this.dt = dt\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    const delaySink = new DelaySink(this.dt, sink, scheduler)\n    return disposeBoth(delaySink, this.source.run(delaySink, scheduler))\n  }\n}\n\nclass DelaySink extends Pipe {\n  constructor (dt, sink, scheduler) {\n    super(sink)\n    this.dt = dt\n    this.scheduler = scheduler\n    this.tasks = []\n  }\n\n  dispose () {\n    this.tasks.forEach(cancelTask)\n  }\n\n  event (t, x) {\n    this.tasks.push(scheduleDelay(this.dt, propagateEventTask(x, this.sink), this.scheduler))\n  }\n\n  end (t) {\n    this.tasks.push(scheduleDelay(this.dt, propagateEndTask(this.sink), this.scheduler))\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport Pipe from '../sink/Pipe'\nimport Map from '../fusion/Map'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { delay } from '@most/scheduler'\n\n/**\n * Limit the rate of events by suppressing events that occur too often\n * @param {Number} period time to suppress events\n * @param {Stream} stream\n * @returns {Stream}\n */\nexport const throttle = (period, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : stream instanceof Map ? commuteMapThrottle(period, stream)\n      : stream instanceof Throttle ? fuseThrottle(period, stream)\n        : new Throttle(period, stream)\n\nconst commuteMapThrottle = (period, mapStream) =>\n  Map.create(mapStream.f, throttle(period, mapStream.source))\n\nconst fuseThrottle = (period, throttleStream) =>\n  new Throttle(Math.max(period, throttleStream.period), throttleStream.source)\n\nclass Throttle {\n  constructor (period, source) {\n    this.period = period\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new ThrottleSink(this.period, sink), scheduler)\n  }\n}\n\nclass ThrottleSink extends Pipe {\n  constructor (period, sink) {\n    super(sink)\n    this.time = 0\n    this.period = period\n  }\n\n  event (t, x) {\n    if (t >= this.time) {\n      this.time = t + this.period\n      this.sink.event(t, x)\n    }\n  }\n}\n/**\n * Wait for a burst of events to subside and emit only the last event in the burst\n * @param {Number} period events occuring more frequently than this\n *  will be suppressed\n * @param {Stream} stream stream to debounce\n * @returns {Stream} new debounced stream\n */\nexport const debounce = (period, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new Debounce(period, stream)\n\nclass Debounce {\n  constructor (dt, source) {\n    this.dt = dt\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return new DebounceSink(this.dt, this.source, sink, scheduler)\n  }\n}\n\nclass DebounceSink {\n  constructor (dt, source, sink, scheduler) {\n    this.dt = dt\n    this.sink = sink\n    this.scheduler = scheduler\n    this.value = void 0\n    this.timer = null\n\n    this.disposable = source.run(this, scheduler)\n  }\n\n  event (t, x) {\n    this._clearTimer()\n    this.value = x\n    this.timer = delay(this.dt, new DebounceTask(this, x), this.scheduler)\n  }\n\n  _event (t, x) {\n    this._clearTimer()\n    this.sink.event(t, x)\n  }\n\n  end (t) {\n    if (this._clearTimer()) {\n      this.sink.event(t, this.value)\n      this.value = undefined\n    }\n    this.sink.end(t)\n  }\n\n  error (t, x) {\n    this._clearTimer()\n    this.sink.error(t, x)\n  }\n\n  dispose () {\n    this._clearTimer()\n    this.disposable.dispose()\n  }\n\n  _clearTimer () {\n    if (this.timer === null) {\n      return false\n    }\n    this.timer.dispose()\n    this.timer = null\n    return true\n  }\n}\n\nclass DebounceTask {\n  constructor (debounce, value) {\n    this.debounce = debounce\n    this.value = value\n  }\n\n  run (t) {\n    this.debounce._event(t, this.value)\n  }\n\n  error (t, e) {\n    this.debounce.error(t, e)\n  }\n\n  dispose () {}\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport fatal from '../fatalError'\nimport { now } from '../source/now'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { compose } from '@most/prelude'\nimport { currentTime } from '@most/scheduler'\n\n/**\n * Turn a Stream<Promise<T>> into Stream<T> by awaiting each promise.\n * Event order is preserved. The stream will fail if any promise rejects.\n */\nexport const awaitPromises = stream =>\n  isCanonicalEmpty(stream) ? empty() : new Await(stream)\n\n/**\n * Create a stream containing only the promise's fulfillment\n * value at the time it fulfills.\n * @param {Promise<T>} p promise\n * @return {Stream<T>} stream containing promise's fulfillment value.\n *  If the promise rejects, the stream will error\n */\nexport const fromPromise = compose(awaitPromises, now)\n\nclass Await {\n  constructor (source) {\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return this.source.run(new AwaitSink(sink, scheduler), scheduler)\n  }\n}\n\nclass AwaitSink {\n  constructor (sink, scheduler) {\n    this.sink = sink\n    this.scheduler = scheduler\n    this.queue = Promise.resolve()\n\n    // Pre-create closures, to avoid creating them per event\n    this._eventBound = x => this.sink.event(currentTime(this.scheduler), x)\n    this._endBound = () => this.sink.end(currentTime(this.scheduler))\n    this._errorBound = e => this.sink.error(currentTime(this.scheduler), e)\n  }\n\n  event (t, promise) {\n    this.queue = this.queue.then(() => this._event(promise))\n      .catch(this._errorBound)\n  }\n\n  end (t) {\n    this.queue = this.queue.then(this._endBound)\n      .catch(this._errorBound)\n  }\n\n  error (t, e) {\n    // Don't resolve error values, propagate directly\n    this.queue = this.queue.then(() => this._errorBound(e))\n      .catch(fatal)\n  }\n\n  _event (promise) {\n    return promise.then(this._eventBound)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexport default class SafeSink {\n  constructor (sink) {\n    this.sink = sink\n    this.active = true\n  }\n\n  event (t, x) {\n    if (!this.active) {\n      return\n    }\n    this.sink.event(t, x)\n  }\n\n  end (t, x) {\n    if (!this.active) {\n      return\n    }\n    this.disable()\n    this.sink.end(t, x)\n  }\n\n  error (t, e) {\n    this.disable()\n    this.sink.error(t, e)\n  }\n\n  disable () {\n    this.active = false\n    return this.sink\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexport function tryEvent (t, x, sink) {\n  try {\n    sink.event(t, x)\n  } catch (e) {\n    sink.error(t, e)\n  }\n}\n\nexport function tryEnd (t, sink) {\n  try {\n    sink.end(t)\n  } catch (e) {\n    sink.error(t, e)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nimport SafeSink from '../sink/SafeSink'\nimport { tryDispose } from '@most/disposable'\nimport { asap } from '@most/scheduler'\nimport { tryEvent, tryEnd } from '../source/tryEvent'\nimport { empty, isCanonicalEmpty } from '../source/empty'\nimport { propagateErrorTask } from '../scheduler/PropagateTask'\nimport { run } from '../run'\nimport { withLocalTime } from './withLocalTime'\n\n/**\n * If stream encounters an error, recover and continue with items from stream\n * returned by f.\n * @param {function(error:*):Stream} f function which returns a new stream\n * @param {Stream} stream\n * @returns {Stream} new stream which will recover from an error by calling f\n */\nexport const recoverWith = (f, stream) =>\n  isCanonicalEmpty(stream) ? empty()\n    : new RecoverWith(f, stream)\n\n/**\n * Create a stream containing only an error\n * @param {*} e error value, preferably an Error or Error subtype\n * @returns {Stream} new stream containing only an error\n */\nexport const throwError = e =>\n  new ErrorStream(e)\n\nclass ErrorStream {\n  constructor (e) {\n    this.value = e\n  }\n\n  run (sink, scheduler) {\n    return asap(propagateErrorTask(this.value, sink), scheduler)\n  }\n}\n\nclass RecoverWith {\n  constructor (f, source) {\n    this.f = f\n    this.source = source\n  }\n\n  run (sink, scheduler) {\n    return new RecoverWithSink(this.f, this.source, sink, scheduler)\n  }\n}\n\nclass RecoverWithSink {\n  constructor (f, source, sink, scheduler) {\n    this.f = f\n    this.sink = new SafeSink(sink)\n    this.scheduler = scheduler\n    this.disposable = source.run(this, scheduler)\n  }\n\n  event (t, x) {\n    tryEvent(t, x, this.sink)\n  }\n\n  end (t) {\n    tryEnd(t, this.sink)\n  }\n\n  error (t, e) {\n    const nextSink = this.sink.disable()\n\n    tryDispose(t, this.disposable, this.sink)\n\n    this._startNext(t, e, nextSink)\n  }\n\n  _startNext (t, x, sink) {\n    try {\n      this.disposable = this._continue(this.f, t, x, sink)\n    } catch (e) {\n      sink.error(t, e)\n    }\n  }\n\n  _continue (f, t, x, sink) {\n    return run(sink, this.scheduler, withLocalTime(t, f(x)))\n  }\n\n  dispose () {\n    return this.disposable.dispose()\n  }\n}\n","import { append, findIndex, remove } from '@most/prelude'\nimport { disposeNone, disposeOnce } from '@most/disposable'\nimport { tryEnd, tryEvent } from '../source/tryEvent'\nimport { isCanonicalEmpty } from '../source/empty'\n\nexport const multicast = stream =>\n  stream instanceof Multicast || isCanonicalEmpty(stream)\n    ? stream\n    : new Multicast(stream)\n\nclass Multicast {\n  constructor (source) {\n    this.source = new MulticastSource(source)\n  }\n  run (sink, scheduler) {\n    return this.source.run(sink, scheduler)\n  }\n}\n\nexport class MulticastSource {\n  constructor (source) {\n    this.source = source\n    this.sinks = []\n    this.disposable = disposeNone()\n  }\n\n  run (sink, scheduler) {\n    const n = this.add(sink)\n    if (n === 1) {\n      this.disposable = this.source.run(this, scheduler)\n    }\n    return disposeOnce(new MulticastDisposable(this, sink))\n  }\n\n  dispose () {\n    const disposable = this.disposable\n    this.disposable = disposeNone()\n    return disposable.dispose()\n  }\n\n  add (sink) {\n    this.sinks = append(sink, this.sinks)\n    return this.sinks.length\n  }\n\n  remove (sink) {\n    const i = findIndex(sink, this.sinks)\n    // istanbul ignore next\n    if (i >= 0) {\n      this.sinks = remove(i, this.sinks)\n    }\n\n    return this.sinks.length\n  }\n\n  event (time, value) {\n    const s = this.sinks\n    if (s.length === 1) {\n      return s[0].event(time, value)\n    }\n    for (let i = 0; i < s.length; ++i) {\n      tryEvent(time, value, s[i])\n    }\n  }\n\n  end (time) {\n    const s = this.sinks\n    for (let i = 0; i < s.length; ++i) {\n      tryEnd(time, s[i])\n    }\n  }\n\n  error (time, err) {\n    const s = this.sinks\n    for (let i = 0; i < s.length; ++i) {\n      s[i].error(time, err)\n    }\n  }\n}\n\nexport class MulticastDisposable {\n  constructor (source, sink) {\n    this.source = source\n    this.sink = sink\n  }\n\n  dispose () {\n    if (this.source.remove(this.sink) === 0) {\n      this.source.dispose()\n    }\n  }\n}\n","/** @license MIT License (c) copyright 2016 original author or authors */\n/* eslint-disable import/first */\nimport { curry2, curry3 } from '@most/prelude'\n\nexport { empty } from './source/empty'\nexport { never } from './source/never'\nexport { now } from './source/now'\nexport { at } from './source/at'\n\nexport { periodic } from './source/periodic'\n\nexport { newStream } from './source/newStream'\n\nimport { zipItems as _zipItems, withItems as _withItems } from './combinator/zipItems'\nexport const zipItems = curry3(_zipItems)\nexport const withItems = curry2(_withItems)\n\n// -----------------------------------------------------------------------\n// Observing\n\nimport { runEffects as _runEffects } from './runEffects'\nimport { run as _run } from './run'\n\nexport const runEffects = curry2(_runEffects)\nexport const run = curry3(_run)\n\n// -------------------------------------------------------\n\nimport { withLocalTime as _withLocalTime } from './combinator/withLocalTime'\n\nexport const withLocalTime = curry2(_withLocalTime)\n\n// -------------------------------------------------------\n\nimport { loop as _loop } from './combinator/loop'\n\nexport const loop = curry3(_loop)\n\n// -------------------------------------------------------\n\nimport { scan as _scan } from './combinator/scan'\n\nexport const scan = curry3(_scan)\n\n// -----------------------------------------------------------------------\n// Extending\n\nimport { startWith as _startWith } from './combinator/startWith'\n\nexport const startWith = curry2(_startWith)\n\n// -----------------------------------------------------------------------\n// Transforming\n\nimport { map as _map, constant as _constant, tap as _tap } from './combinator/transform'\nimport { ap as _ap } from './combinator/applicative'\n\nexport const map = curry2(_map)\nexport const constant = curry2(_constant)\nexport const tap = curry2(_tap)\nexport const ap = curry2(_ap)\n\n// -----------------------------------------------------------------------\n// FlatMapping\n\nimport { chain as _chain, join } from './combinator/chain'\nexport const chain = curry2(_chain)\nexport { join }\n\nimport { continueWith as _continueWith } from './combinator/continueWith'\nexport const continueWith = curry2(_continueWith)\n\nimport { concatMap as _concatMap } from './combinator/concatMap'\nexport const concatMap = curry2(_concatMap)\n\n// -----------------------------------------------------------------------\n// Concurrent merging\n\nimport { mergeConcurrently as _mergeConcurrently, mergeMapConcurrently as _mergeMapConcurrently } from './combinator/mergeConcurrently'\n\nexport const mergeConcurrently = curry2(_mergeConcurrently)\nexport const mergeMapConcurrently = curry3(_mergeMapConcurrently)\n\n// -----------------------------------------------------------------------\n// Merging\n\nimport { merge as _merge, mergeArray } from './combinator/merge'\n\nexport const merge = curry2(_merge)\nexport { mergeArray }\n\n// -----------------------------------------------------------------------\n// Combining\n\nimport { combine as _combine, combineArray as _combineArray } from './combinator/combine'\n\nexport const combine = curry3(_combine)\nexport const combineArray = curry2(_combineArray)\n\n// -----------------------------------------------------------------------\n// Sampling\n\nimport { sample as _sample, snapshot as _snapshot } from './combinator/snapshot'\n\nexport const sample = curry2(_sample)\nexport const snapshot = curry3(_snapshot)\n\n// -----------------------------------------------------------------------\n// Zipping\n\nimport { zip as _zip, zipArray as _zipArray } from './combinator/zip'\n\nexport const zip = curry3(_zip)\nexport const zipArray = curry2(_zipArray)\n\n// -----------------------------------------------------------------------\n// Switching\n\nexport { switchLatest } from './combinator/switch'\n\n// -----------------------------------------------------------------------\n// Filtering\n\nimport { filter as _filter, skipRepeats, skipRepeatsWith as _skipRepeatsWith } from './combinator/filter'\n\nexport const filter = curry2(_filter)\nexport { skipRepeats }\nexport const skipRepeatsWith = curry2(_skipRepeatsWith)\n\n// -----------------------------------------------------------------------\n// Slicing\n\nimport { take as _take, skip as _skip, slice as _slice, takeWhile as _takeWhile, skipWhile as _skipWhile, skipAfter as _skipAfter } from './combinator/slice'\n\nexport const take = curry2(_take)\nexport const skip = curry2(_skip)\nexport const slice = curry3(_slice)\nexport const takeWhile = curry2(_takeWhile)\nexport const skipWhile = curry2(_skipWhile)\nexport const skipAfter = curry2(_skipAfter)\n\n// -----------------------------------------------------------------------\n// Time slicing\n\nimport { until as _until, since as _since, during as _during } from './combinator/timeslice'\n\nexport const until = curry2(_until)\nexport const since = curry2(_since)\nexport const during = curry2(_during)\n\n// -----------------------------------------------------------------------\n// Delaying\n\nimport { delay as _delay } from './combinator/delay'\n\nexport const delay = curry2(_delay)\n\n// -----------------------------------------------------------------------\n// Rate limiting\n\nimport { throttle as _throttle, debounce as _debounce } from './combinator/limit'\n\nexport const throttle = curry2(_throttle)\nexport const debounce = curry2(_debounce)\n\n// -----------------------------------------------------------------------\n// Awaiting Promises\n\nexport { fromPromise, awaitPromises } from './combinator/promises'\n\n// -----------------------------------------------------------------------\n// Error handling\n\nimport { recoverWith as _recoverWith, throwError } from './combinator/errors'\n\nexport const recoverWith = curry2(_recoverWith)\nexport { throwError }\n\n// -----------------------------------------------------------------------\n// Multicasting\n\nexport { multicast, MulticastSource } from './combinator/multicast'\n\n// ----------------------------------------------------------------------\nimport {\n  propagateTask as _propagateTask,\n  propagateEventTask as _propagateEventTask,\n  propagateErrorTask as _propagateErrorTask,\n  propagateEndTask\n} from './scheduler/PropagateTask'\n\nexport const propagateTask = curry3(_propagateTask)\nexport const propagateEventTask = curry2(_propagateEventTask)\nexport const propagateErrorTask = curry2(_propagateErrorTask)\nexport { propagateEndTask }\n"],"names":["fatalError","e","rethrow","propagateTask","run","value","sink","PropagateTask","propagateEventTask","runEvent","propagateEndTask","runEnd","undefined","propagateErrorTask","runError","_run","active","dispose","t","error","fatal","x","event","_","end","empty","EMPTY","isCanonicalEmpty","stream","containsCanonicalEmpty","streams","some","Empty","scheduler","asap","never","NEVER","Never","disposeNone","at","At","time","delay","runAt","now","periodic","Periodic","period","schedulePeriodic","newStream","Stream","Pipe","boundsFrom","unsafeMin","unsafeMax","min","Math","max","mergeBounds","b1","b2","isNilBounds","b","isInfiniteBounds","Infinity","Filter","p","source","FilterSink","create","and","q","FilterMap","f","FilterMapSink","Map","MapSink","compose","SettableDisposable","disposable","disposed","setDisposable","Error","take","n","slice","skip","start","sliceBounds","bounds","isSliceEmpty","commuteMapSlice","Slice","fuseSlice","createSlice","mapStream","sliceStream","sliceSink","SliceSink","takeWhile","TakeWhile","takeWhileSink","TakeWhileSink","skipWhile","SkipWhile","SkipWhileSink","skipping","skipAfter","SkipAfter","SkipAfterSink","withItems","items","zipItems","keepLeft","length","ZipItems","a","ZipItemsSink","index","runEffects","curry2","Promise","resolve","reject","runStream","observer","RunEffectsSink","_end","_error","_disposable","_dispose","tryDispose","RelativeSink","offset","withLocalTime","origin","WithLocalTime","relativeSink","schedulerRelativeTo","loop","stepper","seed","Loop","step","LoopSink","result","scan","initial","Scan","z","d1","d2","ScanSink","disposeBoth","continueWith","ContinueWith","ContinueWithSink","disposeOnce","_startNext","_continue","startWith","map","constant","tap","Tap","TapSink","IndexSink","i","Sink","invoke","args","apply","combine","stream1","stream2","combineArray","Combine","sources","l","disposables","Array","sinks","mergeSink","CombineSink","indexSink","disposeAll","awaiting","values","hasValue","fill","activeCount","indexedValue","_updateReady","ap","fs","xs","mergeConcurrently","concurrency","mergeMapConcurrently","identity","MergeConcurrently","Outer","pending","current","_addInner","_startInner","push","_initInner","innerSink","Inner","mapAndRun","_checkEnd","_endInner","inner","indexOf","splice","shift","outer","chain","join","concatMap","merge","mergeArray","mergeStreams","withoutCanonicalEmpty","Merge","reduce","appendSources","filter","isNotCanonicalEmpty","concat","MergeSink","indexValue","sample","sampler","snapshot","Snapshot","sampleSink","SnapshotSink","valuesDisposable","latest","samplerDisposable","LatestValueSink","HEAD_MAX_SHRINK","TAIL_MIN_SHRINK","Queue","_head","_tail","_capacityMask","_list","tail","_growArray","head","_shrinkArray","isEmpty","_copyArray","newArray","list","len","zip","zipArray","Zip","buffers","zipSink","ZipSink","buffer","ready","ended","emitZipped","mapArray","switchLatest","Switch","switchSink","SwitchSink","_disposeCurrent","Segment","currentTime","_disposeInner","_errorInner","skipRepeats","skipRepeatsWith","same","equals","SkipRepeats","SkipRepeatsSink","init","until","signal","Until","since","Since","during","timeWindow","maxSignal","UntilSink","minSignal","LowerBoundSink","d","SinceSink","allow","delayTime","Delay","dt","delaySink","DelaySink","tasks","forEach","cancelTask","scheduleDelay","throttle","commuteMapThrottle","Throttle","fuseThrottle","throttleStream","ThrottleSink","debounce","Debounce","DebounceSink","timer","_clearTimer","DebounceTask","_event","awaitPromises","Await","fromPromise","AwaitSink","queue","_eventBound","_endBound","_errorBound","promise","then","catch","SafeSink","disable","tryEvent","tryEnd","recoverWith","RecoverWith","throwError","ErrorStream","RecoverWithSink","nextSink","multicast","Multicast","MulticastSource","add","MulticastDisposable","append","remove","findIndex","s","err","curry3","_zipItems","_withItems","_runEffects","_withLocalTime","_loop","_scan","_startWith","_map","_constant","_tap","_ap","_chain","_continueWith","_concatMap","_mergeConcurrently","_mergeMapConcurrently","_merge","_combine","_combineArray","_sample","_snapshot","_zip","_zipArray","_filter","_skipRepeatsWith","_take","_skip","_slice","_takeWhile","_skipWhile","_skipAfter","_until","_since","_during","_delay","_throttle","_debounce","_recoverWith","_propagateTask","_propagateEventTask","_propagateErrorTask"],"mappings":"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"}